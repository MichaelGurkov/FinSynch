---
title: "Synchronization of financial cycles  and financial integration"
author: "Michael Gurkov"
fontsize: 11pt
# output: rmarkdown::word_document
output:
  rmarkdown::pdf_document:
    number_sections: true
    includes:
            in_header: GlobalFinCyclePreambleDoc.tex

abstract: "This paper studies the relationship between financial cycles synchronization and financial integration using data on 30 OECD countries. The results suggest that the relationship is state dependent: While financial integration acts as a \"shock absorber\" during normal times, I find that financial crises increase the \"shock propagation\" feature of financial integration. Overall, the findings show that while financial integration may be desired because it may facilitate risk diversification, additional macroprudential measures may be warranted to account for the risk exposure during crisis times."

bibliography: '`r stringr::str_replace_all(paste(file.path(Sys.getenv("USERPROFILE"),"\\OneDrive - Bank Of Israel\\References\\Financial_Cycle-Global_Financial_Cycle - Copy.bib")),"\\\\","\\\\\\\\\\")`'

nocite: '@*'

vignette: >
  %\VignetteIndexEntry{CycleSynch}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,echo = FALSE,
  message = FALSE,warning = FALSE,cache = TRUE,
  comment = "#>"
)
```


```{r load_package}

devtools::load_all()

library(tidyverse)

library(tidyselect)

library(plm)

library(stargazer)
 
library(purrr)

library(scales)

```


```{r set_output_table_params}

notes_str = paste0(" Financial cycles synchronization",
                   " is the ",
                   "negative of the absolute difference of ",
                   "financial cycle growth between country",
                   " \\textit{i}",
                   " and country \\textit{j} in year \\textit{t}. ",
                   "Bank linkages is the log of total bilateral ",
                   "cross-border banking claims ",
                   "as a share of the two countries’ GDP. ",
                   "Crises is an indicator variable ",
                   "that equals 1 if at least one country ",
                   "undergoes ",
                   "a banking crisis at that year. ",
                   "FD is the sum of the ",
                   "level of each country's financial development ",
                   "index. ",
                   "Trade linkages is the log of bilateral real exports  ",
                   "and imports as a share of the two countries’ GDP. ",
                   "FX stability is a measure of exchange rate stability. ",
                   "Financial openness is a measure of capital account ",
                   "openness. ",
                   "GDP total is the sum of GDP of both countries.")

notes_str_ctrl = paste0(notes_str,
                       "Controls include foreign exchange ",
                       "stability, financial ",
                       "openness, trade linkages and GDP (log). ",
                       "The standard errors are clustered ",
                       "at country pair level and ",
                       "heteroscedasticity robust.")


estimation_table_notes = paste0(
    "\\parbox[t]{8cm}{",
    paste0(
      "The table presents panel estimation that ",
      "includes two-way fixed effects and country pair ",
      " specific linear time trend. ",
      notes_str ,
      "}"
    )
  )


temp_names = c(
  "lag\\(bank_gdp, 1\\)",
  "crisis_ind",
  "fd_ind",
  "lag\\(bank_gdp, 1\\):crisis_ind",
  "lag\\(bank_gdp, 1\\):fd_ind",
  "trade_gdp",
  "fx_stab",
  "fo_ind",
  "gdp_usd"
)


temp_labels = c(
  "Bank linkages (lag)",
  "Crises",
  "FD",
  "Bank linkages (lag) * Crises",
  "Bank linkages (lag) * FD",
  "Trade linkages",
  "FX stability",
  "Financial openness",
  "GDP total"
)

lines_str = list(c("Country pair FE",rep("Yes",3)),
                           c("Year FE",rep("Yes",3)),
                           c("Country pair linear trend",rep("Yes",3)))



```


```{r define_reg_formula_list}

control_vars = c("trade_gdp","fx_stab","fo_ind","gdp_usd")


reg_formula_list = list(
  baseline = paste(
    "fin_synch ~ lag(bank_gdp,1)",
    paste(control_vars,
          collapse = "+"),
    "country_pair:time_trend",
    sep = "+"
  ),
  crises = paste(
    "fin_synch ~ lag(bank_gdp,1) * crisis_ind",
    paste(control_vars,
          collapse = "+"),
    "country_pair:time_trend",
    sep = "+"
  ),
  full_spec = paste(
    "fin_synch ~ lag(bank_gdp,1) * crisis_ind",
    "lag(bank_gdp,1) * fd_ind",
    "lag(bank_gdp,1) * euro_member",
    paste(control_vars,
          collapse = "+"),
    "country_pair:time_trend",
    sep = "+"
  )
)
```


```{r params_setup}

# countries_list = list(
#   oecd_countries = c(
#     "Australia",
#     "Austria",
#     "Belgium",
#     "Canada",
#     "Chile",
#     "Czech_Republic",
#     "Denmark",
#     "Estonia",
#     "Finland",
#     "France",
#     "Germany",
#     "Greece",
#     "Hungary",
#     "Iceland",
#     "Ireland",
#     "Israel",
#     "Italy",
#     "Japan",
#     "Korea",
#     "Latvia",
#     "Lithuania",
#     "Luxembourg",
#     "Mexico",
#     "Netherlands",
#     "New_Zealand",
#     "Norway",
#     "Poland",
#     "Portugal",
#     "Slovak_Republic",
#     "Slovenia",
#     "Spain",
#     "Sweden",
#     "Switzerland",
#     "Turkey",
#     "United_Kingdom"
#     ,
#     "United_States"
#   ),
#   kpp_countries = c(
#     "Australia",
#     "Austria",
#     "Belgium",
#     "Canada",
#     "Switzerland",
#     "Germany",
#     "Denmark",
#     "Spain",
#     "Finland",
#     "France",
#     "United_Kingdom",
#     "Ireland",
#     "Italy",
#     "Japan",
#     "Netherlands",
#     "Portugal",
#     "Sweden",
#     "United_States"
#   ),
#   fsap_countries = c(
#     "Austria",
#     "Belgium",
#     "Germany",
#     "Denmark",
#     "Spain",
#     "France",
#     "Finland",
#     "Greece",
#     "Ireland",
#     "Italy",
#     "Luxembourg",
#     "Netherlands",
#     "Portugal",
#     "Sweden",
#     "United_Kingdom"
#   ),
#   eu_countries = c(
#     "Austria",
#     "Belgium",
#     "Bulgaria",
#     "Croatia",
#     "Cyprus",
#     "Czech_Republic",
#     "Denmark",
#     "Estonia",
#     "Finland",
#     "France",
#     "Germany",
#     "Greece",
#     "Hungary",
#     "Ireland",
#     "Italy",
#     "Latvia",
#     "Lithuania",
#     "Luxembourg",
#     "Malta",
#     "Netherlands",
#     "Poland",
#     "Portugal",
#     "Romania",
#     "Slovak_Republic",
#     "Slovenia",
#     "Spain",
#     "Sweden",
#     "United_Kingdom"
#   ),
#   euro_countries = c(
#     "Austria",
#     "Belgium",
#     "Cyprus",
#     "Estonia",
#     "Finland",
#     "France",
#     "Germany",
#     "Greece",
#     "Ireland",
#     "Italy",
#     "Latvia",
#     "Lithuania",
#     "Luxembourg",
#     "Malta",
#     "Netherlands",
#     "Portugal",
#     "Slovak_Republic",
#     "Slovenia",
#     "Spain"
#   )
# )
# 
# 
# pairs_list = lapply(names(countries_list),
#                     function(temp_name){
#                       apply(combn(countries_list[[temp_name]],2), 2,
#                             function(temp_col){
#                               ifelse(temp_col[1]<temp_col[2],
#                                      paste(temp_col[1],temp_col[2],sep = "-"),
#                                      paste(temp_col[2],temp_col[1],sep = "-"))})
# 
#                     })
# 
# names(pairs_list) = paste(names(countries_list), "pairs", sep = "_")
# 
# countries_list = c(countries_list, pairs_list)
# 
# rm(pairs_list)
# 
# reg_list = list()
# 
# hyp_test_list = list()
# 
# 
# 
# 
# 
# temp_names_lag = c("lag\\(bank_gdp, 1\\)",
#                    "lag\\(Crises, 1\\)",
#                    "lag\\(FD_tot, 1\\)",
#                    "lag\\(Euro_both, 1\\)",
#                    "lag\\(bank_gdp, 1\\):lag\\(Crises, 1\\)",
#                    "lag\\(bank_gdp, 1\\):lag\\(FD_tot, 1\\)",
#                    "lag\\(bank_gdp, 1\\):lag\\(Euro_both, 1\\)")
# 
# 
# 





roll_cor_len = 5


```


```{r child="Import_Data.Rmd"}

```


```{r child="Process_Data.Rmd"}

```


<!-- Regression analysis -->

\section{Introduction} 

```{r child="intro.rmd", eval=FALSE}

```


\section{Literature review} \label{LitReview}

```{r child="lit_review.rmd", eval=FALSE}

```


\section{Data} \label{Data}

```{r child="data.rmd", eval=FALSE}

```


\subsection{Descriptive Statistics} \label{DescStat}

```{r child="Descriptive_Stats.Rmd"}

```


\section{Empirical specification} \label{EmpSpec}

```{r child="empspec.rmd", eval=FALSE}

```


\section{Estimation and results} \label{results}


```{r child="estimation.rmd"}

```


\subsection{Graphical results} \label{Israel}


```{r, child="Selected_countries.Rmd"}

```



<!-- \section{Instrumental variable estimation} -->


```{r child="IV_estimation.Rmd", eval=FALSE}

```


\section{Robustness} \label{Robust}


```{r child="Robustness.Rmd"}

```


\section{Summary and conclusions} \label{conclusions}

This paper studies the effect of banking integration on the synchronization of financial cycles. Theory posits that there may be opposite effects ("shock absorption" vs. "shock propagation") that make the identification of this effect difficult. In a real business cycle setting, @Kalemli-Ozcan2013JF find that banking integration causes business cycles divergence, and they suggest that credit flows from low to high return investments may be the mechanism that causes the divergence.

I hypothesize that the same credit flow will cause financial cycles divergence as well. I find corroborating evidence of a negative association between banking integration and financial cycles synchronization. Moreover, my results suggest that there are other factors that contribute to financial cycle synchronization and make the relationship state dependent.

I find that financial crises increase the "shock propagation" feature of banking integration relative to a baseline setting. This is an important result for
policymakers. It suggests that while banking integration may be desired,
additional macro-prudential measures may be warranted to account for the risk
exposure during crisis times.

Additional factors that contribute to financial cycle synchronization are the
high development of financial markets, which means that policy makers should take
the structural characteristics of their financial markets into account as well.


\section{Appendix}

```{r child="Appendix.Rmd",eval=FALSE}

```



\section{References}

